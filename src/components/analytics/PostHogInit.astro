<script>
  import posthog from 'posthog-js';

  const apiKey = import.meta.env.PUBLIC_POSTHOG_API_KEY;
  const useTracking = import.meta.env.PUBLIC_USE_TRACKING === 'true';

  if (useTracking && apiKey && !window.location.host.includes('127.0.0.1') && !window.location.host.includes('localhost')) {
    posthog.init(apiKey, {
      api_host: 'https://us.i.posthog.com',
      persistence: localStorage.getItem('cookie_consent') === 'yes' ? 'localStorage+cookie' : 'memory',
    });
  }
</script>
